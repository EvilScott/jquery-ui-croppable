(function(a){var b={init:function(b){self.image=b;self.image.parent().append('<div id="crop-box"><div id="resize-handle"></div></div>');a("#crop-box #resize-handle").addClass("ui-resizable-handle ui-resizable-se");a("#crop-box").css({"z-index":"1000",position:"absolute",height:self.image.innerHeight()*.9+"px",width:self.image.innerWidth()*.9+"px",cursor:"move","background-image":'url("'+self.image.attr("src")+'")',"background-position-y":self.image.position().top,"background-position-x":self.image.position().left,"background-repeat":"no-repeat","background-attachment":"fixed"});a("#crop-box #resize-handle").css({"z-index":"1001",position:"absolute",bottom:"0",right:"0",cursor:"se-resize",height:"25px",width:"25px",background:"#B94A48"});self.image.css({opacity:"0.40",filter:"alpha(opacity=40)"});self.image.parent().css({position:"absolute"});a("#crop-box").offset({top:self.image.offset().top+self.image.innerHeight()*.05,left:self.image.offset().left+self.image.innerWidth()*.05});a("#crop-box").draggable({containment:self.image}).resizable({containment:self.image,handles:{se:"#resize-handle"}})},crop:function(){var c=a("#crop-box").innerHeight();var d=a("#crop-box").innerWidth();var e=a("#crop-box").position().left-self.image.position().left;var f=a("#crop-box").position().top-self.image.position().top;var g=d+"x"+c+"+"+e+"+"+f;b.cropCallback.call(this,g)}};a.fn.croppable=function(c,d){b.init(this);b.cropCallback=d;a(c.cropSelector).click(b.crop);return this}})(jQuery)
